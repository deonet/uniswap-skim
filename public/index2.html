<!DOCTYPE html>
<html>
<head>

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
$(document).ready(function(){

	var d = new Date();
  var n = d.getTime();
  // document.getElementById("demo").innerHTML = d;
  $('#body2').append($('<div>', {
	text: d
  }));
 
 
$.ajax({ 
    type: 'GET', 
    url: "db2price.json"+"?"+(new Date().valueOf()) , 
    data: { get_param: 'value' }, 
    dataType: 'json',
    success: function (data) { 
		
		$('#body2').append($('<div>', {
			text: data['tokens'].length
		}));

			var tbl_body = "";
			var odd_even = false;		
		
var tbl_row_head = "<th> </th>";
	tbl_row_head += "<th>USD 0</th>";
	tbl_row_head += "<th colspan=4>USD 1</th>";
	
$.each(data['tokens'][ ((data['tokens'].length)-2) ], function(k , v) {
	if(k=='id'){}
	else{
		tbl_row_head += "<th>"+k+"</th>";
	}
});
tbl_row_head += "<th colspan=5> </th>";
tbl_row_head = "<tr>" + tbl_row_head + "</tr>";

for (i = 0; i < 25; i++) {
	var j = ((data['tokens'].length)-1)-i;
	var tbl_row = "";
	
	// console.log(j);
	
	var usd1 = data['tokens'][j]['MidPriceViaETH_quote2base0'] ; 
	var usdUpdate = data['tokens'][j]['MidPriceViaETH_quote2base1'] ; 
	var updateDt = data['tokens'][j]['updateDt'] ; 
	
	tbl_row += "<td align='right' >"+ (i+1) +".</td>";
	tbl_row += "<td  >$"+ (usd1) +"</td>";
	tbl_row += "<td  >$"+ (usdUpdate) +"</td>";
	tbl_row += "<td  >"+ (updateDt) +"</td>";
	tbl_row += "<td><a target='_BLANK' href='"
		+'https://app.uniswap.org/#/swap?inputCurrency='
		+data['tokens'][j].addressUniq
		+"'>app</a></td>";		
	tbl_row += "<td><a target='_BLANK' href='"
		+'https://info.uniswap.org/token/'
		+data['tokens'][j].addressUniq
		+"'>info</a></td>";
	
	$.each(data['tokens'][j], function(k , v) {
		if(k=='id'){}
		else{
		tbl_row += "<td>"+v+"</td>";}
	});
	
	var selisih = 0;
	//if( data['tokens'][j]['balanceRaw2'] ){
	//	selisih = (  data['tokens'][j]['balanceRaw2'] - data['posts'][j]['balanceRaw'] );
	//	selisih = ( selisih / (data['posts'][j]['balanceRaw'] ) ) * 100;
	//}

	tbl_row += "<td align='left' >"+ (selisih) +" % </td>";		

	tbl_body += "<tr class=\""+( odd_even ? "odd" : "even")+"\">"+tbl_row+"</tr>";
	odd_even = !odd_even; 	
				
	// text += cars[i] + "<br>";
	$('#body2').append($('<div>', {
		// text: data['posts'][j].inputDt
	}));	
}		

$("#customers thead").html(tbl_row_head);			
$("#customers tbody").html(tbl_body);			

	
        $.each(data['tokens'], function(index, element) {
            $('#body2').append($('<div>', {
                // text: element.id
            }));
        });
    }
});
	
  $("p").click(function(){
    // $(this).hide();
  });
 
setTimeout(function() {
	
  location.reload();
}, (1000 * (60*60)) );
  
});


function geocode(geocoder, callback) {
	callback(results);
}

function getModif(cb){
	var aModified = 0;
	var client = new XMLHttpRequest();
	client.open("HEAD", "db2price.json", true);
	client.onreadystatechange = function() {
	  if(this.readyState == 2) {
		// console.log(client.getResponseHeader("Last-Modified"));
		aModified = client.getResponseHeader("Last-Modified");
		cb(aModified);
	  }
	}
	client.send();
	
	console.log(aModified);	
	
	cb(aModified);

	// return aModified;
}

function initialize(modi) {
    //Geocode Address to obtin Lat and Long coordinates for the starting point of our map
    geocoder = new Date();
    geocode(geocoder, function(results) {
		if(results!==modi){
			$('#selector').delay(1).fadeIn('fast');
			setTimeout(function(){
				location.reload();
			},(1000*10));
		}
		//console.log(results);
		
		setTimeout(function() {
			initialize(results)
		}, (100 * 10) );
		
    });
}
function geocode(geocoder, callback) {
    //do geocoding here...
    
	var client = new XMLHttpRequest();
	client.open("HEAD", "db2price.json"+"?"+(new Date().valueOf()) , true);
	client.onreadystatechange = function() {
	  if(this.readyState == 2) {
		//console.log(client.getResponseHeader("Last-Modified"));
		aModified = client.getResponseHeader("Last-Modified");
		callback(aModified);
	  }
	}
	client.send();

}

$('#selector').delay(1).hide('fast');

	var client = new XMLHttpRequest();
	client.open("HEAD", "db2price.json"+"?"+(new Date().valueOf()) , true);
	client.onreadystatechange = function() {
	  if(this.readyState == 2) {
		//console.log(client.getResponseHeader("Last-Modified"));
		aModified = client.getResponseHeader("Last-Modified");
		initialize(aModified);
	  }
	}
	client.send();




// Set population limit of aquarium to 10
const popLimit = 2;
// Start off with 0 fish
let fish = 0;
// Initiate while loop to run until fish reaches population limit
while (fish < popLimit) {
    // add one fish for each iteration
    fish++;
    //console.log("There's room for " + (popLimit - fish) + " more fish.");
}




var timeBegan = null
    , timeStopped = null
    , stoppedDuration = 0
    , started = null;

function start() {
    if (timeBegan === null) {
        timeBegan = new Date();
    }

    if (timeStopped !== null) {
        stoppedDuration += (new Date() - timeStopped);
    }
    console.log(stoppedDuration);

    started = setInterval(clockRunning, 10);	
}

function stop() {
    timeStopped = new Date();
    clearInterval(started);
}
 
function reset() {
    clearInterval(started);
    stoppedDuration = 0;
    timeBegan = null;
    timeStopped = null;
    document.getElementById("display-area").innerHTML = "00:00:00.000";
}

function clockRunning(){
    var currentTime = new Date()
        , timeElapsed = new Date(currentTime - timeBegan - stoppedDuration)
        , hour = timeElapsed.getUTCHours()
        , min = timeElapsed.getUTCMinutes()
        , sec = timeElapsed.getUTCSeconds()
        , ms = timeElapsed.getUTCMilliseconds();

    document.getElementById("display-area").innerHTML = 
        (hour > 9 ? hour : "0" + hour) + ":" + 
        (min > 9 ? min : "0" + min) + ":" + 
        (sec > 9 ? sec : "0" + sec) + "." + 
        (ms > 99 ? ms : ms > 9 ? "0" + ms : "00" + ms);
};
start();
</script>


<style>
.loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 0.5s linear infinite;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}


#customers {
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

#customers td, #customers th {
  border: 1px solid #ddd;
  padding: 8px;
}

#customers tr:nth-child(even){background-color: #f2f2f2;}

#customers tr:hover {background-color: #ddd;}

#customers th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: #4CAF50;
  color: white;
}
</style>

</head>
<body>

<style>
ul#menu li {
  display:inline;
  padding-right: 20px;
}
</style>

<ul id="menu" >
	<li><a href="index.html">1</a>
	<li><a href="index2.html">2</a>
	
	</li>
</ul>


<div id='selector' style="display:none;position:fixed;left:100px;top:160px;" class="loader"></div>

<div>       <p><output id="display-area">00:00:00.000</output></p>
        </div>
		
		<div id='body2'></div><br>

<table id="customers"><thead></thead><tbody></tbody></table>
		
        <!-- div syle=''>
            <button id="toggle-button" onClick="start()">Start</button>
            <button id="toggle-button" onClick="stop()">Stop</button>
            <button id="reset-button" onClick="reset()">Reset</button>
        </div -->

<!-- 

<p>If you click on me, I will disappear.</p>
<p>Click me away!</p>
<p>Click me too!</p>

-->

</body>
</html>
